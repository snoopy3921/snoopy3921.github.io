---
layout: default
title: "08 Interrupts"
parent: Linux device driver on Luckfox
nav_order: 8
nav_exclude: false
search_exclude: false
has_children: false
has_toc: false
---
## 08 Interrupts
So in our life, there are so many times we get interrupted, like when we are playing games and our mom calls us to turn off the radio for her.

As I am working with microcontrollers, an interrupt is a signal sent from hardware to the CPU that needs to be handled. I believe it is the same in a Linux system. The service that handles interrupts is called an interrupt handler or interrupt service routine (ISR). We know interrupts as async events.

### What will happen when the interrupt comes?
1. Upon receiving an interrupt, the interrupt controller sends a signal to the processor. (In the arm cortex m3, it uses the interrupt controller called NVIC to handle).
2. The processor detects this signal and interrupts its current execution to handle the interrupt.
3. The processor can then notify the operating system that an interrupt has occurred and go back to the previous execution flow.

{: .note }
Interrupts can come anytime.

{: .note }
Interrupts can come together.

{: .note }
CPU can not handle interrupt while it is in critical sections, so keep critical sections as short and few as possible.

### Interrupts and Exceptions
Exceptions are often discussed at the same time as interrupts. But exceptions are generated by CPU itself, some exceptions can be named are  ``"Division by zero"``, ``"Page fault"``, ...

So the difference is:
+ ``Interrupts`` – asynchronous interrupts generated by hardware.
+ ``Exceptions`` – synchronous interrupts generated by the processor.

There is a further classification of interrupts and exceptions.
#### **Interrupts**
+ ``maskable``
    + can be ignored
    + signaled via INT pin
+ ``non-maskable``
    + cannot be ignored
    + signaled via NMI pin

Most interrupts are maskable, which means we can temporarily postpone running the interrupt handler when we disable the interrupt until interrupt is re-enabled. However, there are a few critical interrupts that can not be disabled/postponed (NMI, ...).

#### **Exceptions**

+ ``Falts`` – Like Divide by zero, Page Fault, Segmentation Fault.
+ ``Traps`` – Reported immediately following the execution of the trapping instruction. Like Breakpoints.
+ ``Aborts`` – Aborts are used to report severe errors, such as hardware failures and invalid or inconsistent values in system tables.